name: Deploy to Docker swarm

on : 
#   workflow_run: 
#     workflows: [Node.js CI]
#     types :
#       - completed
  push:
    branches: [ main, develop ]
    
jobs:
  update:
    name: update
    runs-on: ubuntu-latest
    steps:
      - name: multiple command
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.SSH_HOST }}
          username: ${{ secrets.SSH_USER }}
          password: ${{ secrets.SSH_PASSWORD }}
          script : |
            cd /home/admin/cesi/verre-tech 
            git pull origin master
            docker-compose build
            docker stack up -c
